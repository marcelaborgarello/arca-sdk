bun test v1.3.8 (b64edcb4)

tests\unit\calculations.test.ts:
(pass) Cálculos de Facturación > debe calcular el subtotal correctamente
(pass) Cálculos de Facturación > debe calcular el IVA correctamente
(pass) Cálculos de Facturación > debe calcular el total correctamente
(pass) Cálculos de Facturación > debe redondear valores correctamente
(pass) Cálculos de Facturación > debe calcular correctamente cuando incluyeIva es true

tests\unit\crypto.test.ts:
(pass) validateCertificate > debe validar certificado PEM correcto
(pass) validateCertificate > debe rechazar certificado inválido
(pass) validatePrivateKey > debe validar clave privada PKCS#8
(pass) validatePrivateKey > debe validar clave privada RSA
(pass) validatePrivateKey > debe rechazar clave inválida
(pass) signCMS > debe lanzar error con certificado/clave inválidos [16.00ms]
(pass) signCMS > debe tener la firma correcta y ser una función exportada

tests\unit\ticket.test.ts:
(pass) TicketManager > debe retornar null si no hay ticket
(pass) TicketManager > debe guardar y recuperar un ticket válido
(pass) TicketManager > debe considerar inválido un ticket que expira en menos de 5 min
(pass) TicketManager > debe considerar válido un ticket que expira en más de 5 min
(pass) TicketManager > debe limpiar el ticket al llamar clearTicket()

tests\unit\validation.test.ts:
(pass) WsaaService - Validaciones > debe aceptar configuración válida
(pass) WsaaService - Validaciones > debe rechazar CUIT inválido
(pass) WsaaService - Validaciones > debe rechazar certificado inválido
(pass) WsaaService - Validaciones > debe rechazar clave privada inválida
(pass) WsaaService - Validaciones > debe rechazar servicio vacío
(pass) WsaaService - Validaciones > debe aceptar clave privada con formato RSA

tests\unit\xml.test.ts:
(pass) buildTRA > debe generar XML TRA válido [16.00ms]
(pass) buildTRA > debe incluir timestamps válidos
87 |             sign: ticket.credentials.sign,
88 |             generationTime: new Date(ticket.header.generationTime),
89 |             expirationTime: new Date(ticket.header.expirationTime),
90 |         };
91 |     } catch (error) {
92 |         if (error instanceof ArcaAuthError) throw error;
                                                       ^
ArcaAuthError: Ticket WSAA inválido o malformado dentro de loginCmsReturn
      at parseWsaaResponse (C:\Users\impre\dev\arca-sdk\src\utils\xml.ts:92:51)
      at <anonymous> (C:\Users\impre\dev\arca-sdk\tests\unit\xml.test.ts:45:24)
(fail) parseWsaaResponse > debe parsear respuesta WSAA exitosa
(pass) parseWsaaResponse > debe detectar SOAP Fault y lanzar error descriptivo [15.00ms]
(pass) parseWsaaResponse > debe lanzar error si estructura es inválida
(pass) validateCUIT > debe validar CUIT correcto
(pass) validateCUIT > debe rechazar CUIT con formato incorrecto

1 tests failed:
(fail) parseWsaaResponse > debe parsear respuesta WSAA exitosa

 29 pass
 1 fail
 60 expect() calls
Ran 30 tests across 5 files. [296.00ms]
